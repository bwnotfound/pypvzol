# Python implementation of 植物大战僵尸ol助手

使用Python实现的植物大战僵尸ol助手，具有一些原有助手没有的功能。

## 介绍

本项目目的是实现原有助手没有但十分有必要的功能，例如自动练级，自动进化，自动合成，自动使用更多物品，自动购买更多物品等等。

由于带有一定的练手性质，所以代码可能较为混乱，同时更新随缘。

## 声明

本项目为开源项目，项目的贡献者不知道所有用户的输入，因此不负责任何用户的输入。因使用本项目而造成的任何损失和影响都与本项目贡献者无关，用户需对自己的操作负责。本项目仅供学习交流使用，不得用于商业用途，否则后果自负。

## 使用规约

1.  本项目是基于学术交流目的建立，仅供交流与学习使用，并非为生产环境准备。
2.  任何基于本项目制作的视频都必须在简介中声明项目来源。
3.  不可用本项目进行网络攻击。
4.  禁止使用该项目从事违法行为与宗教、政治等活动，该项目维护者坚决抵制上述行为，不同意此条则禁止使用该项目。
5.  继续使用视为已同意本仓库 README 所述相关条例，本仓库 README 已进行劝导义务，不对后续可能存在问题负责。
6.  如果将此项目用于任何其他企划，请提前联系并告知本仓库作者，十分感谢。

## 使用提醒

**由于我只有24区和46区的账号，因此其它区没有测试过，绝对会有bug。** 如果有bug请提交issue或者pr。

## 使用方法

### 环境配置

我用的是python3.10.6版本，暂未测试其他版本。需要python3.10.6版本的请到 https://www.python.org/downloads/release/python-3106/ 下载，或者直接点击 https://www.python.org/ftp/python/3.10.6/python-3.10.6-amd64.exe 下载

### 运行源码

```shell
# 克隆仓库
$ git clone  ; cd 
# 安装依赖。如果可以的话，建议使用虚拟环境venv
$ pip install -r requirements.txt
```

上述步骤中的“克隆仓库”可以替换为“点击右上角的绿色按钮，然后点击“Download ZIP”下载，然后解压到你想要的位置即可。”

安装完环境后，打开根目录下的config文件夹，修改其中的config.json文件，将region改为你所在的区号，将cookie改为你的cookie值。cookie获取可以在植物大战僵尸ol网页版登录后，按F12打开开发者工具，在上方工具栏中点击“控制台”，然后下方输入```document.cookie```，回车，即可获取到cookie值。如果你用了原有助手，那么把原有助手的Config文件夹下你对应区的xml文件打开，搜索```UserCookies```也能获取到cookie值。

将cookie值复制到config.json文件中的cookie值中，注意不要删除引号，也不要有多余的引号。最后保存文件。

配置完成后，在根目录下打开控制台，输入```python webUI.py```并回车即可运行。（如果配置了虚拟环境，需要切换到虚拟环境后再运行上述代码）

### 注意事项

1.  如果要切换账号，不仅需要重新配置config.json文件，还需要删除根目录下的data文件（因为还没做多人设置）。
2.  46区的服务器对于访问有频率限制，所以如果你的账号是46区的，那么这个助手大概率是不好用的。
   用过老助手的也都知道，请求发送太快会418，实际上就是暂时被ban掉了。（有待测试是封禁ip还是封禁对应cookie）
3.  46区服务器依托答辩，很卡，所以请耐心等待，同时如果等待时间超过15s，那么大概率是418了，请等待一段时间再使用
4.  除了24和46区测试过外（实际上是新老区的区别），其它区没号就没有测试，所以有bug请提交issue或者pr。(1区这样的老区暂时不会去管，因为api不一样，有空再说吧)

### 操作方法

1.  设置中，在列表框中点击对应的植物或洞口（有的可以多选）然后按键盘上的```delete```删除键或```Backspace```退格键即可删除对应选中的东西。

### 代码说明


## 后话

~~关注B站[蓝白bw](https://space.bilibili.com/107433411)喵， 关注[蓝白bw](https://space.bilibili.com/107433411)谢谢喵~~

### Q&A

1.  Q:  为什么要叠这么多甲呢？
    
    A:  别问，问就是没版权爱发电。

2.  Q:  为什么要为这个要死不死的游戏写个助手呢？
    
    A:  ~~因为我想写，所以我写了。~~ 其实一方面是练手，一方面也是因为我还算是比较喜欢这个游戏，同时挂机资源够了又不想自己手动刷手动练级，所以就写了这个助手。

## Bug list:
列一些知道但暂时还没去管的bug

1.  老区（例如1区）和新区的api不一致，例如url中是"pvz-"开头的
2.  暂未添加血瓶选择功能，所以主力植物不强的话可能会死，Log文本框还未与主线程独立，会卡死，各个挑战次数统计还未实现，
   所以每次打开都会重新计算
3.  暂时未添加多人配置设置，所以一次暂时只能添加一个人的设置，换成另外一个人后就只能重新设置
4.  46区的回血设置容易失败，暂时不知道原理，所以加了个多次尝试试图减少bug

## TODO LIST:
1.  移植scripts中的代码到webUI中
2.  重构代码，使代码更加规范化
3.  支持难度选择
4.  添加自动进化
5.  添加自动合成
6.  添加自动刷品
7.  添加自动使用更多物品
8.  添加自动购买更多物品